<div class="card">
  <h2>Pedidos de esta semana</h2>

  <div class="loading" *ngIf="isLoading">
    Cargando pedidos...
  </div>

  <div class="alert alert-danger" *ngIf="errorMessage">
    {{ errorMessage }}
  </div>

  <div class="empty-state" *ngIf="!isLoading && bocadillos.length === 0 && !errorMessage">
    <p>No hay pedidos esta semana</p>
    <p>¬°S√© el primero en pedir un bocadillo!</p>
  </div>

  <div class="bocadillos-grid" *ngIf="!isLoading && bocadillos.length > 0">
    <div class="bocadillo-card" *ngFor="let bocadillo of bocadillos">
      <div class="bocadillo-header">
        <h3>{{ bocadillo.nombre }}</h3>
        <div class="action-buttons" *ngIf="canEditOrDelete(bocadillo)">
          <button
            class="btn-edit"
            (click)="editBocadillo(bocadillo)"
            title="Editar pedido"
          >
            ‚úèÔ∏è
          </button>
          <button
            class="btn-delete"
            (click)="deleteBocadillo(bocadillo._id!)"
            title="Eliminar pedido"
          >
            üóëÔ∏è
          </button>
        </div>
      </div>

      <div class="bocadillo-details">
        <div class="detail-row">
          <span class="detail-label">Tama√±o:</span>
          <span class="detail-value">{{ getTamanoLabel(bocadillo.tamano) }}</span>
        </div>

        <div class="detail-row">
          <span class="detail-label">Pan:</span>
          <span class="detail-value">{{ getTipoPanLabel(bocadillo.tipoPan) }}</span>
        </div>

        <div class="detail-row" *ngIf="bocadillo.bocataPredefinido">
          <span class="detail-label">Tipo:</span>
          <span class="detail-value badge-predefinido">{{ bocadillo.bocataPredefinido }}</span>
        </div>
      </div>

      <div class="ingredientes">
        <div class="ingredientes-label">Ingredientes:</div>
        <div class="ingredientes-list">
          <span
            *ngFor="let ingrediente of bocadillo.ingredientes"
            class="ingrediente-tag"
          >
            {{ ingrediente }}
          </span>
        </div>
      </div>

      <!-- Precio y Pago (Admin) -->
      <div class="payment-section" *ngIf="isAdmin">
        <div class="payment-row">
          <label class="payment-label">Precio:</label>
          <input
            type="number"
            class="price-input"
            [value]="bocadillo.precio || ''"
            (blur)="updatePrecio(bocadillo, $event)"
            placeholder="0.00"
            min="0"
            step="0.01"
          />
          <span class="currency">‚Ç¨</span>
        </div>
        <div class="payment-row">
          <label class="payment-label">
            <input
              type="checkbox"
              class="payment-checkbox"
              [checked]="bocadillo.pagado"
              [disabled]="!bocadillo.precio"
              (change)="togglePagado(bocadillo, $event)"
            />
            Pagado
          </label>
        </div>
      </div>

      <!-- Precio y Estado (Usuarios normales) -->
      <div class="payment-info" *ngIf="!isAdmin && bocadillo.precio">
        <div class="info-row">
          <span class="info-label">Precio:</span>
          <span class="info-value">{{ formatCurrency(bocadillo.precio) }}</span>
        </div>
        <div class="info-row">
          <span class="info-label">Estado:</span>
          <span class="info-value" [class.paid]="bocadillo.pagado" [class.unpaid]="!bocadillo.pagado">
            {{ bocadillo.pagado ? '‚úì Pagado' : '‚úó Pendiente' }}
          </span>
        </div>
      </div>

      <div class="bocadillo-footer">
        <span class="fecha">
          {{ bocadillo.fechaCreacion | date: 'dd/MM/yyyy HH:mm' }}
        </span>
      </div>
    </div>
  </div>
</div>
